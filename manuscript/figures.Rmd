---
title: Figures
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,cache = TRUE)
```

```{r library_load,cache=FALSE}
source('../code/library_load.R')
```

```{r prep}
source('../code/data_prep.R')
```

```{r siteLocations,fig.cap='Map showing locations of the nine sites used for collection of phenotypic descriptors.',fig.width=3,fig.height=5}
source('../code/site_locations.R')
site_locations_map
```

```{r site_differences,fig.cap='Differences between sites in phenotypic descriptors analysed by supervised Random Forest. a) Multidimensional scaling (MDS) plot of random forest proximity values of individual trees scaled to two dimensions. Mean margin value shown. b) Relative descriptor Gini importances measures.',fig.height=5}
source('../code/site_differences.R')
grid.arrange(site_differences$a,site_differences$b,nrow = 1)
```

```{r DI_space,fig.cap='Two dimensional continuum of the phenotypic decline indexes for oak decline severity.',fig.height=3,fig.width=5}
DIspace()
```

```{r descriptor_contributions, fig.height = 5,fig.cap = 'Descriptor importance scores from random forest models for relative contributions to\ndecline index measures. a) Phenotypic decline index (PDI). b) Decline acuteness index (DAI)'}
source('../code/descriptor_contributions.R')
descriptor_contributions %>%
  wrap_plots()
```

```{r PDI_response_surfaces,fig.height = 6,fig.cap='PDI response surfaces for simulated descriptor values from trained Random Forest models. All other descriptors were set at the values of those of the trees with the lowest PDI used for trainig the models',cache=TRUE}
source('../code/PDI_response_surfaces.R')
grid.arrange(PDI_response_plot$`a)`,PDI_response_plot$`b)`,PDI_response_plot$`c)`,PDI_response_plot$legend,nrow = 2,newpage = F)
```

```{r DAI_response_surfaces,fig.height = 8,fig.cap='DAI response surfaces for simulated descriptor values from trained Random Forest models. All other descriptors were set at the values of those of the trees with the lowest PDI used for trainig the models',cache=FALSE}
source('../code/DAI_response_surfaces.R')
grid.arrange(DAI_response_plot$`a)`,DAI_response_plot$`b)`,DAI_response_plot$`c)`,DAI_response_plot$`d)`,DAI_response_plot$`e)`,DAI_response_plot$`f)`,DAI_response_plot$legend,ncol = 3,layout_matrix = rbind(c(1,4,7),c(2,5,7),c(3,6,7)),widths = c(4,4,1),newpage = F)
```